<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Player TT</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #video-frame { width: 100%; height: 90vh; display: flex; justify-content: center; align-items: center; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; cursor: pointer; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="overlay" id="tap-to-start">
        <h1>[ ЗАПУСТИТЬ БОТА ]</h1>
        <p>Нажми на экран для авто-просмотра</p>
    </div>

    <div id="video-frame"></div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const playlist = [
            { id: "7601947636333169942", time: 5000 },
            { id: "7601966443319577859", time: 3000 }
        ];

        let index = 0;

        document.getElementById('tap-to-start').onclick = function() {
            this.classList.add('hidden');
            playCycle();
        };

        function playCycle() {
            const container = document.getElementById('video-frame');
            const video = playlist[index];

            // Очищаем и создаем новый эмбед
            container.innerHTML = `
                <blockquote class="tiktok-embed" 
                    cite="https://www.tiktok.com/video/${video.id}" 
                    data-video-id="${video.id}"
                    data-autoplay="true" 
                    style="width: 100%; height: 100%;">
                    <section></section>
                </blockquote>
            `;

            // Принудительно загружаем скрипт TikTok для инициализации плеера
            const oldScript = document.getElementById('tt-sdk');
            if (oldScript) oldScript.remove();
            
            const script = document.createElement('script');
            script.id = 'tt-sdk';
            script.src = "https://www.tiktok.com/embed.js";
            document.body.appendChild(script);

            // Ждем указанное время и переключаем
            setTimeout(() => {
                index = (index + 1) % playlist.length;
                playCycle();
            }, video.time);
        }
    </script>
</body>
</html>
